\documentclass[a4paper,11pt]{article}
\usepackage[margin=1in,top=0.5in]{geometry}
\usepackage{amsmath,amssymb,bm}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usetikzlibrary{automata,positioning,arrows.meta}
\usepackage{enumitem}

% Formatting settings
\setlength{\parindent}{0pt}
\setlist[enumerate]{itemsep=0.3em, topsep=0.5em}

\newcommand{\vsp}{\vspace{0.5em}}
\newcommand{\bsp}{\vspace{1em}}
\newcommand{\ruler}{
    \vspace{1em}
    \hrule
    \vspace{1em}
}
\newcommand{\bsq}{\hfill $\blacksquare$}

\begin{document}

{\Large \textbf{ICMA 346 Project Report: The Tennessee Pterodactyls}}\\
{\normalsize Artem Kiselev, 6580846}

\section{Problem Requierments and Formulation}
We have a yearly budget of \$50~million to sign free agents from the following table:

\begin{table}[htbp]
\centering
\renewcommand{\arraystretch}{1}
\begin{tabular}{rlcccccc}
\hline
& \textbf{Player} & \textbf{Position} & \textbf{Points} & \textbf{Rebounds} & \textbf{Assists} & \textbf{Minutes} & \textbf{Salary (\$M)} \\
\hline
1  & Mack Madonna        & Back court  & 14.7 & 4.4  & 9.3 & 40.3 & 8.2  \\
2  & Darrell Boards      & Front court & 12.6 & 10.6 & 2.1 & 34.5 & 6.5  \\
3  & Silk Curry          & Back court  & 13.5 & 8.7  & 1.7 & 29.3 & 5.2  \\
4  & Ramon Dion          & Back court  & 27.1 & 7.1  & 4.5 & 42.5 & 16.4 \\
5  & Joe Eastcoast       & Back court  & 18.1 & 7.5  & 5.1 & 41.0 & 14.3 \\
6  & Abdul Famous        & Front court & 22.8 & 9.5  & 2.4 & 38.5 & 23.5 \\
7  & Hiram Grant         & Front court & 9.3  & 12.2 & 3.5 & 31.5 & 4.7  \\
8  & Antoine Roadman     & Front court & 10.2 & 12.6 & 1.8 & 44.4 & 7.1  \\
9  & Fred Westcoast      & Front court & 16.9 & 2.5  & 11.4 & 42.7 & 15.8 \\
10 & Magic Jordan        & Back court  & 28.5 & 6.5  & 1.3 & 38.1 & 26.4 \\
11 & Barry Bird          & Front court & 24.8 & 8.6  & 6.9 & 42.6 & 19.5 \\
12 & Grant Hall          & Front court & 11.3 & 12.5 & 3.2 & 39.5 & 8.6  \\
\hline
\end{tabular}
\caption{Free Agent Information}
\end{table}

\vspace{-0.5em}
The requirements are:
\begin{enumerate}
  \item Sign exactly 5 players.
  \item Total points per game $\ge80$.
  \item Total rebounds per game $\ge40$.
  \item Total assists per game $\ge25$.
  \item Total minutes per game $\ge190$.
  \item At most 2 front court and at most 3 back court players. As we must sign 5 players, we can simplify this to just require exactly 2 front court players, since the 3 back court player requirement will naturally follow.
  \item Select the group that satisfies requirements 1-6 at minimum total salary cost.
\end{enumerate}

Define a vector $\bm{x} \in \{0, 1\}^{12}$, consisting of the following binary decision variables:
$$x_i=\begin{cases}1,&\text{if player }i\text{ is signed,}\\0,&\text{otherwise,}\end{cases}\quad i=1,\dots,12.$$ 
Let
$\bm{s},\bm{p},\bm{r},\bm{a},\bm{m}\in\mathbb{R}_{+}^{12}$ be the salary, points, rebounds, assists, minutes vectors, and
$\bm{f}\in\{0,1\}^{12}$ indicate front court (1) or back court (0).

\vspace{1em}
We can now formulate the integer linear programming model:
\[
\begin{aligned}
\text{minimize} \quad & z=\bm{s}^\top\bm{x}\\
\text{subject to}\quad
&\bm{1}^\top\bm{x}=5,\\
&\bm{p}^\top\bm{x}\ge80,\\
&\bm{r}^\top\bm{x}\ge40,\\
&\bm{a}^\top\bm{x}\ge25,\\
&\bm{m}^\top\bm{x}\ge190,\\
&\bm{f}^\top\bm{x}=2, \\
&\bm{x}, \bm{f} \in \{0,1\}^{12}, \\
&\bm{s}, \bm{p}, \bm{r}, \bm{a}, \bm{m} \in \mathbb{R}_+^{12}.
\end{aligned}
\]

\section{Binary Linear Programming Solution}

\subsection{Raw CPLEX Output}
\begin{verbatim}
solution for: tennessee_pterodactlys
objective: 52.2
status: OPTIMAL_SOLUTION(2)
Mack Madonna=1
Ramon Dion=1
Joe Eastcoast=1
Hiram Grant=1
Grant Hall=1
\end{verbatim}

\subsection{Interpretation}
We can see that we have reached a status of an optimal solution, and our objective function (minimum cost) is 52.2, with the listed five players having a binary value of 1, thus being selected. Below are two tables showing the statistics of the selected players and their aggregate stats:

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.2} % Adjust vertical spacing as in your example
    \begin{tabular}{rlcccccc}
        \hline
        & \textbf{Player} & \textbf{Position} & \textbf{Points} & \textbf{Rebounds} & \textbf{Assists} & \textbf{Minutes} & \textbf{Salary (\$M)} \\
        \hline
        % Using the indices from the original table for selected players
        1 & Mack Madonna    & Back court        & 14.7            & 4.4               & 9.3              & 40.3             & 8.2                   \\
        4 & Ramon Dion      & Back court        & 27.1            & 7.1               & 4.5              & 42.5             & 16.4                  \\
        5 & Joe Eastcoast   & Back court        & 18.1            & 7.5               & 5.1              & 41.0             & 14.3                  \\
        7 & Hiram Grant     & Front court       & 9.3             & 12.2              & 3.5              & 31.5             & 4.7                   \\
        12 & Grant Hall     & Front court       & 11.3            & 12.5              & 3.2              & 39.5             & 8.6                   \\
        \hline
    \end{tabular}
    \caption{Player Stats}
    \label{tab:selected_players}
\end{table}

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.2} % Consistent vertical spacing
    \begin{tabular}{lc}
        \hline
        \textbf{Statistic}          & \textbf{Total} \\
        \hline
        Total Points (Objective)    & 80.50          \\
        Total Salary                & \$52.20M         \\
        Total Rebounds              & 43.7           \\
        Total Assists               & 25.6           \\
        Total Minutes               & 194.8          \\
        Total Front Court Players   & 2              \\
        \hline
    \end{tabular}
    \caption{Aggregate Stats}
    \label{tab:team_totals}
\end{table}

\textbf{Notes:} We can see that Ramon Dion is an incredibly valuable player in terms of scoring output especially when comparing him to the other highly scoring free agents. Mack Madonna, Hiram Grant, and Grant Hall are very valuable all around players with standout assists and rebound statistics respectively, with very cheap salaries in comparison to other agents, making them very cost effective. Lastly, Joe Eastcoast is just a solid jack of all trades player, with decent stats in every category.

\section{Answers to Case Questions}

\textbf{Question A.} 
Formulate an integer linear programming model (ILP) to help the general manager and coach determine which players they should sign and solve it by using the computer.

\ruler

\textbf{Answer A.} The ILP model, along with the five players to sign have been displayed in the section above.

\ruler

\vsp

\textbf{Question B.} 
Is the money provided by the owner sufficient to sign the group of players identified in (A)? If not, reformulate the model so that the available funds are a constraint and the objective is to maximize the average points of the group.

\ruler

\textbf{Answer B.} As seen in the section above, the total salary of the selected roster is \$52.2 million, whereas the budget is \$50.0 million, thus meaning we do not have enough money to sign this combination of players. The LP reformulation and new solution are presented below.

\subsection{Question B LP Reformulation}

We will keep all the defined variables and vectors as before, and only change the objective function along with the constraints.
\[
\begin{aligned}
\text{maximize} \quad & z=\bm{p}^\top\bm{x}\\
\text{subject to}\quad
&\bm{s}^\top\bm{x} \leq 50, \\
&\bm{x}, \in \{0,1\}^{12}, \\
&\bm{p}, \bm{s}  \in \mathbb{R}_+^{12}.
\end{aligned}
\]

\subsection{Raw CPLEX Output}
\begin{verbatim}
solution for: tennessee_pterodactlys_B
objective: 82.7
status: OPTIMAL_SOLUTION(2)
Mack Madonna=1
Silk Curry=1
Ramon Dion=1
Joe Eastcoast=1
Hiram Grant=1
\end{verbatim}

\subsection{Interpretation}
Once again, we have reached a status of an optimal solution, and our objective function (max total points) is 82.7, with five players having a binary value of 1 thus being selected. As prior, tables showing the players' statistics and the aggregate roster stats are presented below.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.2} % Adjust vertical spacing
    \begin{tabular}{rlcccccc}
        \hline
        & \textbf{Player} & \textbf{Position} & \textbf{Points} & \textbf{Rebounds} & \textbf{Assists} & \textbf{Minutes} & \textbf{Salary (\$M)} \\
        \hline
        % Using the indices from the original table for selected players
        1 & Mack Madonna    & Back court        & 14.7            & 4.4               & 9.3              & 40.3             & 8.2                   \\
        3 & Silk Curry      & Back court        & 13.5            & 8.7               & 1.7              & 29.3             & 5.2                   \\
        4 & Ramon Dion      & Back court        & 27.1            & 7.1               & 4.5              & 42.5             & 16.4                  \\
        5 & Joe Eastcoast   & Back court        & 18.1            & 7.5               & 5.1              & 41.0             & 14.3                  \\
        7 & Hiram Grant     & Front court       & 9.3             & 12.2              & 3.5              & 31.5             & 4.7                   \\
        \hline
    \end{tabular}
    \caption{Player Stats for Formulation B}
    \label{tab:selected_players_B}
\end{table}

\newpage

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.2} % Consistent vertical spacing
    \begin{tabular}{lc}
        \hline
        \textbf{Statistic}          & \textbf{Total} \\
        \hline
        Max Total Points (Objective) & 82.70          \\
        Total Salary                & \$48.80M         \\
        Total Rebounds              & 39.9           \\
        Total Assists               & 24.1           \\
        Total Minutes               & 184.6          \\
        Total Front Court Players   & 1              \\
        \hline
    \end{tabular}
    \caption{Aggregate Stats for Formulation B}
    \label{tab:team_totals_B}
\end{table}

\textbf{Notes:} We have kept approximately the same roster, except for replacing Grant Hill with Silk Curry, likely due to the difference in point scoring and salary letting us reach the budget requirements. As a result, our point scoring is slightly up, however the rest of the statistics have slightly suffered, especially the number of rebounds and minutes played. Furthermore, we now have a more unbalanced roster with 4 back court players and only 1 front court player.

\section{Sensitivity Analysis}
Since sensitivity analysis must be performed on the LP relaxation, we must change the binary variables to continous ones between 0 and 1. I am assuming that we should do the sensitivity analysis on the original/first LP formulation.

\subsection{Raw CPLEX Output}
\begin{verbatim}
solution for: tennessee_pterodactlys_LP
objective: 47.4889
status: OPTIMAL_SOLUTION(2)
Mack Madonna=1.000
Darrell Boards=0.151
Silk Curry=1.000
Ramon Dion=1.000
Joe Eastcoast=0.000
Hiram Grant=0.656
Antoine Roadman=0.647
Fred Westcoast=0.435
Barry Bird=0.111
\end{verbatim}

\newpage
\subsection{Interpretation}
\begin{table}[h!]
    \centering
    \begin{tabular}{rllcccccc}
        \hline
        & \textbf{Player} & \textbf{Contrib} & \textbf{Pos} & \textbf{Pts} & \textbf{Rbds} & \textbf{Asts} & \textbf{Mins} & \textbf{Salary (\$M)} \\
        \hline
        % Values are manually entered based on the LP solution provided
        1  & Mack Madonna    & 1.000                 & Back court        & 14.7            & 4.4               & 9.3              & 40.3             & 8.2                   \\
        2  & Darrell Boards  & 0.151                 & Front court       & 12.6            & 10.6              & 2.1              & 34.5             & 6.5                   \\
        3  & Silk Curry      & 1.000                 & Back court        & 13.5            & 8.7               & 1.7              & 29.3             & 5.2                   \\
        4  & Ramon Dion      & 1.000                 & Back court        & 27.1            & 7.1               & 4.5              & 42.5             & 16.4                  \\
        % Joe Eastcoast=0.000 (not included as contribution is zero)
        7  & Hiram Grant     & 0.656                 & Front court       & 9.3             & 12.2              & 3.5              & 31.5             & 4.7                   \\
        8  & Antoine Roadman & 0.647                 & Front court       & 10.2            & 12.6              & 1.8              & 44.4             & 7.1                   \\
        9  & Fred Westcoast  & 0.435                 & Front court       & 16.9            & 2.5               & 11.4             & 42.7             & 15.8                  \\
        11 & Barry Bird      & 0.111                 & Front court       & 24.8            & 8.6               & 6.9              & 42.6             & 19.5                  \\
        \hline
    \end{tabular}
    \caption{Player Stats for LP Relaxation}
    \label{tab:selected_players_LP}
\end{table}

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.2} % Consistent vertical spacing
    \begin{tabular}{lc}
        \hline
        \textbf{Statistic}          & \textbf{Total} \\
        \hline
        Total Salary (Objective)    & \$47.49M         \\ % Objective directly from CPLEX output
        Total Points                & 80.00          \\ % Calculated: (1*14.7) + (0.151*12.6) + (1*13.5) + (1*27.1) + (0.656*9.3) + (0.647*10.2) + (0.435*16.9) + (0.111*24.8) = 80.00 (approx)
        Total Rebounds              & 40.00          \\ % Calculated: (1*4.4) + (0.151*10.6) + (1*8.7) + (1*7.1) + (0.656*12.2) + (0.647*12.6) + (0.435*2.5) + (0.111*8.6) = 40.00 (approx)
        Total Assists               & 25.00          \\ % Calculated: (1*9.3) + (0.151*2.1) + (1*1.7) + (1*4.5) + (0.656*3.5) + (0.647*1.8) + (0.435*11.4) + (0.111*6.9) = 25.00 (approx)
        Total Minutes               & 190.00         \\ % Calculated: (1*40.3) + (0.151*34.5) + (1*29.3) + (1*42.5) + (0.656*31.5) + (0.647*44.4) + (0.435*42.7) + (0.111*42.6) = 190.00 (approx)
        Total Front Court Players   & 2.00           \\ % Calculated: (0.151*1) + (0.656*1) + (0.647*1) + (0.435*1) + (0.111*1) = 2.00 (approx)
        Total Number of Players     & 5.00           \\ % Calculated: Sum of all contributions (1+0.151+1+1+0.656+0.647+0.435+0.111) = 5.00
        \hline
    \end{tabular}
    \caption{Aggregated Stats for LP Relaxation}
    \label{tab:team_totals_LP}
\end{table}
\section{Insights from Sensitivity Analysis}

\end{document}